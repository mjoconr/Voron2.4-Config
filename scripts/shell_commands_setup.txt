Run this command to add gcode shell execute
```
ln -sf ~/kiauh/resources/gcode_shell_command.py ~/klipper/klippy/extras/gcode_shell_command.py
```

Somewhere in your config (mine is in a macros directory a in file called shell_commands.cfg) you need to add the following
```
[gcode_shell_command generate_graphs]
command: ~/klipper_config/scripts/generate_graphs.sh
timeout: 60.
verbose: True

[gcode_macro GENERATE_GRAPHS]
gcode:
    RUN_SHELL_COMMAND CMD=generate_graphs

[gcode_macro DO_INPUTSHAPER]
gcode:
    SHAPER_CALIBRATE
    GENERATE_GRAPHS
```

Add this a file called generate_graphs.sh can be placed anywhere but suggest ~/klipper_config/scripts/generate_graphs.sh
Run command
chmod a+x  ~/klipper_config/scripts/generate_graphs.sh
 ```
#!/bin/bash

FILES=`ls /tmp/calibration_data_*.csv`

mkdir -p ~/klipper_config/graphs

for file in ${FILES}
do
        name=`basename ${file} .csv`
        ~/klipper/scripts/calibrate_shaper.py $file ~/klipper_config/graphs/${name}.png
        mv $file $file.processed
done
```
